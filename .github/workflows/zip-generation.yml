name: Create ZIP on Push (Self Hosted)

on:
  push:
    branches:
      - "**"   # Run on all branches

jobs:
  zip_project:
    runs-on: self-hosted   # Your Windows laptop

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Create ZIP File
        run: |
          powershell -command "Compress-Archive -Path . -DestinationPath project.zip -Force"

      - name: Upload ZIP as Artifact
        uses: actions/upload-artifact@v4
        with:
          name: project-zip
          path: project.zip
          retention-days: 7

      - name: Show Windows Toast Notification
        run: |
          powershell -command "
            [Windows.UI.Notifications.ToastNotificationManager, Windows.UI.Notifications, ContentType = WindowsRuntime] | Out-Null;
            $template = [Windows.UI.Notifications.ToastNotificationManager]::GetTemplateContent([Windows.UI.Notifications.ToastTemplateType]::ToastText01);
            $text = $template.GetElementsByTagName('text');
            $text.Item(0).AppendChild($template.CreateTextNode('GitHub Action: Job Completed!'));
            $toast = [Windows.UI.Notifications.ToastNotification]::new($template);
            $notifier = [Windows.UI.Notifications.ToastNotificationManager]::CreateToastNotifier('GitHub Actions');
            $notifier.Show($toast);
          "
